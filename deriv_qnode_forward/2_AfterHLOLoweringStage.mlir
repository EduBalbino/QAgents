module @deriv_qnode_forward {
  func.func public @jit_deriv_qnode_forward(%arg0: tensor<4x8x3xf32>, %arg1: tensor<8xf32>) -> tensor<4x8x3xf32> attributes {llvm.emit_c_interface} {
    %0 = gradient.grad "auto" @qnode_forward_0(%arg0, %arg1) {diffArgIndices = dense<0> : tensor<1xi64>} : (tensor<4x8x3xf32>, tensor<8xf32>) -> tensor<4x8x3xf32>
    return %0 : tensor<4x8x3xf32>
  }
  func.func public @qnode_forward_0(%arg0: tensor<4x8x3xf32>, %arg1: tensor<8xf32>) -> tensor<f64> attributes {diff_method = "adjoint", llvm.linkage = #llvm.linkage<internal>, qnode} {
    %cst = arith.constant dense<3.14159274> : tensor<f32>
    %c0_i64 = arith.constant 0 : i64
    %extracted_slice = tensor.extract_slice %arg0[3, 0, 2] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed = tensor.collapse_shape %extracted_slice [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted = tensor.extract %collapsed[] : tensor<f32>
    %extracted_slice_0 = tensor.extract_slice %arg0[3, 0, 1] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_1 = tensor.collapse_shape %extracted_slice_0 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_2 = tensor.extract %collapsed_1[] : tensor<f32>
    %extracted_slice_3 = tensor.extract_slice %arg0[3, 0, 0] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_4 = tensor.collapse_shape %extracted_slice_3 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_5 = tensor.extract %collapsed_4[] : tensor<f32>
    %extracted_slice_6 = tensor.extract_slice %arg0[2, 0, 2] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_7 = tensor.collapse_shape %extracted_slice_6 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_8 = tensor.extract %collapsed_7[] : tensor<f32>
    %extracted_slice_9 = tensor.extract_slice %arg0[2, 0, 1] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_10 = tensor.collapse_shape %extracted_slice_9 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_11 = tensor.extract %collapsed_10[] : tensor<f32>
    %extracted_slice_12 = tensor.extract_slice %arg0[2, 0, 0] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_13 = tensor.collapse_shape %extracted_slice_12 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_14 = tensor.extract %collapsed_13[] : tensor<f32>
    %extracted_slice_15 = tensor.extract_slice %arg0[1, 6, 2] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_16 = tensor.collapse_shape %extracted_slice_15 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_17 = tensor.extract %collapsed_16[] : tensor<f32>
    %extracted_slice_18 = tensor.extract_slice %arg0[1, 6, 1] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_19 = tensor.collapse_shape %extracted_slice_18 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_20 = tensor.extract %collapsed_19[] : tensor<f32>
    %extracted_slice_21 = tensor.extract_slice %arg0[1, 6, 0] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_22 = tensor.collapse_shape %extracted_slice_21 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_23 = tensor.extract %collapsed_22[] : tensor<f32>
    %extracted_slice_24 = tensor.extract_slice %arg0[0, 7, 2] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_25 = tensor.collapse_shape %extracted_slice_24 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_26 = tensor.extract %collapsed_25[] : tensor<f32>
    %extracted_slice_27 = tensor.extract_slice %arg0[0, 7, 1] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_28 = tensor.collapse_shape %extracted_slice_27 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_29 = tensor.extract %collapsed_28[] : tensor<f32>
    %extracted_slice_30 = tensor.extract_slice %arg0[0, 7, 0] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_31 = tensor.collapse_shape %extracted_slice_30 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_32 = tensor.extract %collapsed_31[] : tensor<f32>
    %0 = tensor.empty() : tensor<8xf32>
    %1 = linalg.generic {indexing_maps = [affine_map<(d0) -> ()>, affine_map<(d0) -> (d0)>], iterator_types = ["parallel"]} ins(%cst : tensor<f32>) outs(%0 : tensor<8xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<8xf32>
    %2 = linalg.generic {indexing_maps = [affine_map<(d0) -> (d0)>, affine_map<(d0) -> (d0)>, affine_map<(d0) -> (d0)>], iterator_types = ["parallel"]} ins(%1, %arg1 : tensor<8xf32>, tensor<8xf32>) outs(%0 : tensor<8xf32>) {
    ^bb0(%in: f32, %in_444: f32, %out: f32):
      %126 = arith.mulf %in, %in_444 : f32
      linalg.yield %126 : f32
    } -> tensor<8xf32>
    %extracted_slice_33 = tensor.extract_slice %2[7] [1] [1] : tensor<8xf32> to tensor<1xf32>
    %collapsed_34 = tensor.collapse_shape %extracted_slice_33 [] : tensor<1xf32> into tensor<f32>
    %extracted_35 = tensor.extract %collapsed_34[] : tensor<f32>
    quantum.device shots(%c0_i64) ["/home/pichau/QAgents/.venv/lib/python3.12/site-packages/pennylane_lightning/liblightning_gpu_catalyst.so", "LightningGPUSimulator", "{}"]
    %3 = quantum.alloc( 8) : !quantum.reg
    %4 = quantum.extract %3[ 7] : !quantum.reg -> !quantum.bit
    %5 = arith.extf %extracted_35 : f32 to f64
    %out_qubits = quantum.custom "RY"(%5) %4 : !quantum.bit
    %6 = arith.extf %extracted_32 : f32 to f64
    %out_qubits_36 = quantum.custom "RZ"(%6) %out_qubits : !quantum.bit
    %7 = arith.extf %extracted_29 : f32 to f64
    %out_qubits_37 = quantum.custom "RY"(%7) %out_qubits_36 : !quantum.bit
    %8 = arith.extf %extracted_26 : f32 to f64
    %out_qubits_38 = quantum.custom "RZ"(%8) %out_qubits_37 : !quantum.bit
    %extracted_slice_39 = tensor.extract_slice %arg0[0, 6, 2] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_40 = tensor.collapse_shape %extracted_slice_39 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_41 = tensor.extract %collapsed_40[] : tensor<f32>
    %extracted_slice_42 = tensor.extract_slice %arg0[0, 6, 1] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_43 = tensor.collapse_shape %extracted_slice_42 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_44 = tensor.extract %collapsed_43[] : tensor<f32>
    %extracted_slice_45 = tensor.extract_slice %arg0[0, 6, 0] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_46 = tensor.collapse_shape %extracted_slice_45 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_47 = tensor.extract %collapsed_46[] : tensor<f32>
    %extracted_slice_48 = tensor.extract_slice %2[6] [1] [1] : tensor<8xf32> to tensor<1xf32>
    %collapsed_49 = tensor.collapse_shape %extracted_slice_48 [] : tensor<1xf32> into tensor<f32>
    %extracted_50 = tensor.extract %collapsed_49[] : tensor<f32>
    %9 = quantum.extract %3[ 6] : !quantum.reg -> !quantum.bit
    %10 = arith.extf %extracted_50 : f32 to f64
    %out_qubits_51 = quantum.custom "RY"(%10) %9 : !quantum.bit
    %11 = arith.extf %extracted_47 : f32 to f64
    %out_qubits_52 = quantum.custom "RZ"(%11) %out_qubits_51 : !quantum.bit
    %12 = arith.extf %extracted_44 : f32 to f64
    %out_qubits_53 = quantum.custom "RY"(%12) %out_qubits_52 : !quantum.bit
    %13 = arith.extf %extracted_41 : f32 to f64
    %out_qubits_54 = quantum.custom "RZ"(%13) %out_qubits_53 : !quantum.bit
    %extracted_slice_55 = tensor.extract_slice %arg0[0, 5, 2] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_56 = tensor.collapse_shape %extracted_slice_55 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_57 = tensor.extract %collapsed_56[] : tensor<f32>
    %extracted_slice_58 = tensor.extract_slice %arg0[0, 5, 1] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_59 = tensor.collapse_shape %extracted_slice_58 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_60 = tensor.extract %collapsed_59[] : tensor<f32>
    %extracted_slice_61 = tensor.extract_slice %arg0[0, 5, 0] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_62 = tensor.collapse_shape %extracted_slice_61 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_63 = tensor.extract %collapsed_62[] : tensor<f32>
    %extracted_slice_64 = tensor.extract_slice %2[5] [1] [1] : tensor<8xf32> to tensor<1xf32>
    %collapsed_65 = tensor.collapse_shape %extracted_slice_64 [] : tensor<1xf32> into tensor<f32>
    %extracted_66 = tensor.extract %collapsed_65[] : tensor<f32>
    %14 = quantum.extract %3[ 5] : !quantum.reg -> !quantum.bit
    %15 = arith.extf %extracted_66 : f32 to f64
    %out_qubits_67 = quantum.custom "RY"(%15) %14 : !quantum.bit
    %16 = arith.extf %extracted_63 : f32 to f64
    %out_qubits_68 = quantum.custom "RZ"(%16) %out_qubits_67 : !quantum.bit
    %17 = arith.extf %extracted_60 : f32 to f64
    %out_qubits_69 = quantum.custom "RY"(%17) %out_qubits_68 : !quantum.bit
    %18 = arith.extf %extracted_57 : f32 to f64
    %out_qubits_70 = quantum.custom "RZ"(%18) %out_qubits_69 : !quantum.bit
    %extracted_slice_71 = tensor.extract_slice %arg0[0, 4, 2] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_72 = tensor.collapse_shape %extracted_slice_71 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_73 = tensor.extract %collapsed_72[] : tensor<f32>
    %extracted_slice_74 = tensor.extract_slice %arg0[0, 4, 1] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_75 = tensor.collapse_shape %extracted_slice_74 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_76 = tensor.extract %collapsed_75[] : tensor<f32>
    %extracted_slice_77 = tensor.extract_slice %arg0[0, 4, 0] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_78 = tensor.collapse_shape %extracted_slice_77 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_79 = tensor.extract %collapsed_78[] : tensor<f32>
    %extracted_slice_80 = tensor.extract_slice %2[4] [1] [1] : tensor<8xf32> to tensor<1xf32>
    %collapsed_81 = tensor.collapse_shape %extracted_slice_80 [] : tensor<1xf32> into tensor<f32>
    %extracted_82 = tensor.extract %collapsed_81[] : tensor<f32>
    %19 = quantum.extract %3[ 4] : !quantum.reg -> !quantum.bit
    %20 = arith.extf %extracted_82 : f32 to f64
    %out_qubits_83 = quantum.custom "RY"(%20) %19 : !quantum.bit
    %21 = arith.extf %extracted_79 : f32 to f64
    %out_qubits_84 = quantum.custom "RZ"(%21) %out_qubits_83 : !quantum.bit
    %22 = arith.extf %extracted_76 : f32 to f64
    %out_qubits_85 = quantum.custom "RY"(%22) %out_qubits_84 : !quantum.bit
    %23 = arith.extf %extracted_73 : f32 to f64
    %out_qubits_86 = quantum.custom "RZ"(%23) %out_qubits_85 : !quantum.bit
    %extracted_slice_87 = tensor.extract_slice %arg0[0, 3, 2] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_88 = tensor.collapse_shape %extracted_slice_87 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_89 = tensor.extract %collapsed_88[] : tensor<f32>
    %extracted_slice_90 = tensor.extract_slice %arg0[0, 3, 1] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_91 = tensor.collapse_shape %extracted_slice_90 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_92 = tensor.extract %collapsed_91[] : tensor<f32>
    %extracted_slice_93 = tensor.extract_slice %arg0[0, 3, 0] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_94 = tensor.collapse_shape %extracted_slice_93 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_95 = tensor.extract %collapsed_94[] : tensor<f32>
    %extracted_slice_96 = tensor.extract_slice %2[3] [1] [1] : tensor<8xf32> to tensor<1xf32>
    %collapsed_97 = tensor.collapse_shape %extracted_slice_96 [] : tensor<1xf32> into tensor<f32>
    %extracted_98 = tensor.extract %collapsed_97[] : tensor<f32>
    %24 = quantum.extract %3[ 3] : !quantum.reg -> !quantum.bit
    %25 = arith.extf %extracted_98 : f32 to f64
    %out_qubits_99 = quantum.custom "RY"(%25) %24 : !quantum.bit
    %26 = arith.extf %extracted_95 : f32 to f64
    %out_qubits_100 = quantum.custom "RZ"(%26) %out_qubits_99 : !quantum.bit
    %27 = arith.extf %extracted_92 : f32 to f64
    %out_qubits_101 = quantum.custom "RY"(%27) %out_qubits_100 : !quantum.bit
    %28 = arith.extf %extracted_89 : f32 to f64
    %out_qubits_102 = quantum.custom "RZ"(%28) %out_qubits_101 : !quantum.bit
    %extracted_slice_103 = tensor.extract_slice %arg0[0, 2, 2] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_104 = tensor.collapse_shape %extracted_slice_103 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_105 = tensor.extract %collapsed_104[] : tensor<f32>
    %extracted_slice_106 = tensor.extract_slice %arg0[0, 2, 1] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_107 = tensor.collapse_shape %extracted_slice_106 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_108 = tensor.extract %collapsed_107[] : tensor<f32>
    %extracted_slice_109 = tensor.extract_slice %arg0[0, 2, 0] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_110 = tensor.collapse_shape %extracted_slice_109 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_111 = tensor.extract %collapsed_110[] : tensor<f32>
    %extracted_slice_112 = tensor.extract_slice %2[2] [1] [1] : tensor<8xf32> to tensor<1xf32>
    %collapsed_113 = tensor.collapse_shape %extracted_slice_112 [] : tensor<1xf32> into tensor<f32>
    %extracted_114 = tensor.extract %collapsed_113[] : tensor<f32>
    %29 = quantum.extract %3[ 2] : !quantum.reg -> !quantum.bit
    %30 = arith.extf %extracted_114 : f32 to f64
    %out_qubits_115 = quantum.custom "RY"(%30) %29 : !quantum.bit
    %31 = arith.extf %extracted_111 : f32 to f64
    %out_qubits_116 = quantum.custom "RZ"(%31) %out_qubits_115 : !quantum.bit
    %32 = arith.extf %extracted_108 : f32 to f64
    %out_qubits_117 = quantum.custom "RY"(%32) %out_qubits_116 : !quantum.bit
    %33 = arith.extf %extracted_105 : f32 to f64
    %out_qubits_118 = quantum.custom "RZ"(%33) %out_qubits_117 : !quantum.bit
    %extracted_slice_119 = tensor.extract_slice %arg0[0, 0, 2] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_120 = tensor.collapse_shape %extracted_slice_119 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_121 = tensor.extract %collapsed_120[] : tensor<f32>
    %extracted_slice_122 = tensor.extract_slice %arg0[0, 0, 1] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_123 = tensor.collapse_shape %extracted_slice_122 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_124 = tensor.extract %collapsed_123[] : tensor<f32>
    %extracted_slice_125 = tensor.extract_slice %arg0[0, 0, 0] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_126 = tensor.collapse_shape %extracted_slice_125 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_127 = tensor.extract %collapsed_126[] : tensor<f32>
    %extracted_slice_128 = tensor.extract_slice %2[0] [1] [1] : tensor<8xf32> to tensor<1xf32>
    %collapsed_129 = tensor.collapse_shape %extracted_slice_128 [] : tensor<1xf32> into tensor<f32>
    %extracted_130 = tensor.extract %collapsed_129[] : tensor<f32>
    %34 = quantum.extract %3[ 0] : !quantum.reg -> !quantum.bit
    %35 = arith.extf %extracted_130 : f32 to f64
    %out_qubits_131 = quantum.custom "RY"(%35) %34 : !quantum.bit
    %36 = arith.extf %extracted_127 : f32 to f64
    %out_qubits_132 = quantum.custom "RZ"(%36) %out_qubits_131 : !quantum.bit
    %37 = arith.extf %extracted_124 : f32 to f64
    %out_qubits_133 = quantum.custom "RY"(%37) %out_qubits_132 : !quantum.bit
    %38 = arith.extf %extracted_121 : f32 to f64
    %out_qubits_134 = quantum.custom "RZ"(%38) %out_qubits_133 : !quantum.bit
    %extracted_slice_135 = tensor.extract_slice %arg0[0, 1, 2] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_136 = tensor.collapse_shape %extracted_slice_135 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_137 = tensor.extract %collapsed_136[] : tensor<f32>
    %extracted_slice_138 = tensor.extract_slice %arg0[0, 1, 1] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_139 = tensor.collapse_shape %extracted_slice_138 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_140 = tensor.extract %collapsed_139[] : tensor<f32>
    %extracted_slice_141 = tensor.extract_slice %arg0[0, 1, 0] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_142 = tensor.collapse_shape %extracted_slice_141 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_143 = tensor.extract %collapsed_142[] : tensor<f32>
    %extracted_slice_144 = tensor.extract_slice %2[1] [1] [1] : tensor<8xf32> to tensor<1xf32>
    %collapsed_145 = tensor.collapse_shape %extracted_slice_144 [] : tensor<1xf32> into tensor<f32>
    %extracted_146 = tensor.extract %collapsed_145[] : tensor<f32>
    %39 = quantum.extract %3[ 1] : !quantum.reg -> !quantum.bit
    %40 = arith.extf %extracted_146 : f32 to f64
    %out_qubits_147 = quantum.custom "RY"(%40) %39 : !quantum.bit
    %41 = arith.extf %extracted_143 : f32 to f64
    %out_qubits_148 = quantum.custom "RZ"(%41) %out_qubits_147 : !quantum.bit
    %42 = arith.extf %extracted_140 : f32 to f64
    %out_qubits_149 = quantum.custom "RY"(%42) %out_qubits_148 : !quantum.bit
    %43 = arith.extf %extracted_137 : f32 to f64
    %out_qubits_150 = quantum.custom "RZ"(%43) %out_qubits_149 : !quantum.bit
    %out_qubits_151:2 = quantum.custom "CNOT"() %out_qubits_134, %out_qubits_150 : !quantum.bit, !quantum.bit
    %out_qubits_152:2 = quantum.custom "CNOT"() %out_qubits_151#1, %out_qubits_118 : !quantum.bit, !quantum.bit
    %out_qubits_153:2 = quantum.custom "CNOT"() %out_qubits_152#1, %out_qubits_102 : !quantum.bit, !quantum.bit
    %out_qubits_154:2 = quantum.custom "CNOT"() %out_qubits_153#1, %out_qubits_86 : !quantum.bit, !quantum.bit
    %out_qubits_155:2 = quantum.custom "CNOT"() %out_qubits_154#1, %out_qubits_70 : !quantum.bit, !quantum.bit
    %out_qubits_156:2 = quantum.custom "CNOT"() %out_qubits_155#1, %out_qubits_54 : !quantum.bit, !quantum.bit
    %out_qubits_157:2 = quantum.custom "CNOT"() %out_qubits_156#1, %out_qubits_38 : !quantum.bit, !quantum.bit
    %44 = arith.extf %extracted_23 : f32 to f64
    %out_qubits_158 = quantum.custom "RZ"(%44) %out_qubits_157#0 : !quantum.bit
    %45 = arith.extf %extracted_20 : f32 to f64
    %out_qubits_159 = quantum.custom "RY"(%45) %out_qubits_158 : !quantum.bit
    %46 = arith.extf %extracted_17 : f32 to f64
    %out_qubits_160 = quantum.custom "RZ"(%46) %out_qubits_159 : !quantum.bit
    %extracted_slice_161 = tensor.extract_slice %arg0[1, 4, 2] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_162 = tensor.collapse_shape %extracted_slice_161 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_163 = tensor.extract %collapsed_162[] : tensor<f32>
    %extracted_slice_164 = tensor.extract_slice %arg0[1, 4, 1] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_165 = tensor.collapse_shape %extracted_slice_164 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_166 = tensor.extract %collapsed_165[] : tensor<f32>
    %extracted_slice_167 = tensor.extract_slice %arg0[1, 4, 0] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_168 = tensor.collapse_shape %extracted_slice_167 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_169 = tensor.extract %collapsed_168[] : tensor<f32>
    %47 = arith.extf %extracted_169 : f32 to f64
    %out_qubits_170 = quantum.custom "RZ"(%47) %out_qubits_155#0 : !quantum.bit
    %48 = arith.extf %extracted_166 : f32 to f64
    %out_qubits_171 = quantum.custom "RY"(%48) %out_qubits_170 : !quantum.bit
    %49 = arith.extf %extracted_163 : f32 to f64
    %out_qubits_172 = quantum.custom "RZ"(%49) %out_qubits_171 : !quantum.bit
    %extracted_slice_173 = tensor.extract_slice %arg0[1, 0, 2] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_174 = tensor.collapse_shape %extracted_slice_173 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_175 = tensor.extract %collapsed_174[] : tensor<f32>
    %extracted_slice_176 = tensor.extract_slice %arg0[1, 0, 1] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_177 = tensor.collapse_shape %extracted_slice_176 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_178 = tensor.extract %collapsed_177[] : tensor<f32>
    %extracted_slice_179 = tensor.extract_slice %arg0[1, 0, 0] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_180 = tensor.collapse_shape %extracted_slice_179 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_181 = tensor.extract %collapsed_180[] : tensor<f32>
    %out_qubits_182:2 = quantum.custom "CNOT"() %out_qubits_157#1, %out_qubits_151#0 : !quantum.bit, !quantum.bit
    %50 = arith.extf %extracted_181 : f32 to f64
    %out_qubits_183 = quantum.custom "RZ"(%50) %out_qubits_182#1 : !quantum.bit
    %51 = arith.extf %extracted_178 : f32 to f64
    %out_qubits_184 = quantum.custom "RY"(%51) %out_qubits_183 : !quantum.bit
    %52 = arith.extf %extracted_175 : f32 to f64
    %out_qubits_185 = quantum.custom "RZ"(%52) %out_qubits_184 : !quantum.bit
    %extracted_slice_186 = tensor.extract_slice %arg0[1, 2, 2] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_187 = tensor.collapse_shape %extracted_slice_186 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_188 = tensor.extract %collapsed_187[] : tensor<f32>
    %extracted_slice_189 = tensor.extract_slice %arg0[1, 2, 1] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_190 = tensor.collapse_shape %extracted_slice_189 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_191 = tensor.extract %collapsed_190[] : tensor<f32>
    %extracted_slice_192 = tensor.extract_slice %arg0[1, 2, 0] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_193 = tensor.collapse_shape %extracted_slice_192 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_194 = tensor.extract %collapsed_193[] : tensor<f32>
    %53 = arith.extf %extracted_194 : f32 to f64
    %out_qubits_195 = quantum.custom "RZ"(%53) %out_qubits_153#0 : !quantum.bit
    %54 = arith.extf %extracted_191 : f32 to f64
    %out_qubits_196 = quantum.custom "RY"(%54) %out_qubits_195 : !quantum.bit
    %55 = arith.extf %extracted_188 : f32 to f64
    %out_qubits_197 = quantum.custom "RZ"(%55) %out_qubits_196 : !quantum.bit
    %out_qubits_198:2 = quantum.custom "CNOT"() %out_qubits_185, %out_qubits_197 : !quantum.bit, !quantum.bit
    %out_qubits_199:2 = quantum.custom "CNOT"() %out_qubits_198#1, %out_qubits_172 : !quantum.bit, !quantum.bit
    %out_qubits_200:2 = quantum.custom "CNOT"() %out_qubits_199#1, %out_qubits_160 : !quantum.bit, !quantum.bit
    %out_qubits_201:2 = quantum.custom "CNOT"() %out_qubits_200#1, %out_qubits_198#0 : !quantum.bit, !quantum.bit
    %56 = arith.extf %extracted_14 : f32 to f64
    %out_qubits_202 = quantum.custom "RZ"(%56) %out_qubits_201#1 : !quantum.bit
    %57 = arith.extf %extracted_11 : f32 to f64
    %out_qubits_203 = quantum.custom "RY"(%57) %out_qubits_202 : !quantum.bit
    %58 = arith.extf %extracted_8 : f32 to f64
    %out_qubits_204 = quantum.custom "RZ"(%58) %out_qubits_203 : !quantum.bit
    %extracted_slice_205 = tensor.extract_slice %arg0[2, 3, 2] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_206 = tensor.collapse_shape %extracted_slice_205 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_207 = tensor.extract %collapsed_206[] : tensor<f32>
    %extracted_slice_208 = tensor.extract_slice %arg0[2, 3, 1] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_209 = tensor.collapse_shape %extracted_slice_208 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_210 = tensor.extract %collapsed_209[] : tensor<f32>
    %extracted_slice_211 = tensor.extract_slice %arg0[2, 3, 0] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_212 = tensor.collapse_shape %extracted_slice_211 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_213 = tensor.extract %collapsed_212[] : tensor<f32>
    %extracted_slice_214 = tensor.extract_slice %arg0[1, 5, 2] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_215 = tensor.collapse_shape %extracted_slice_214 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_216 = tensor.extract %collapsed_215[] : tensor<f32>
    %extracted_slice_217 = tensor.extract_slice %arg0[1, 5, 1] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_218 = tensor.collapse_shape %extracted_slice_217 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_219 = tensor.extract %collapsed_218[] : tensor<f32>
    %extracted_slice_220 = tensor.extract_slice %arg0[1, 5, 0] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_221 = tensor.collapse_shape %extracted_slice_220 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_222 = tensor.extract %collapsed_221[] : tensor<f32>
    %59 = arith.extf %extracted_222 : f32 to f64
    %out_qubits_223 = quantum.custom "RZ"(%59) %out_qubits_156#0 : !quantum.bit
    %60 = arith.extf %extracted_219 : f32 to f64
    %out_qubits_224 = quantum.custom "RY"(%60) %out_qubits_223 : !quantum.bit
    %61 = arith.extf %extracted_216 : f32 to f64
    %out_qubits_225 = quantum.custom "RZ"(%61) %out_qubits_224 : !quantum.bit
    %extracted_slice_226 = tensor.extract_slice %arg0[1, 1, 2] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_227 = tensor.collapse_shape %extracted_slice_226 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_228 = tensor.extract %collapsed_227[] : tensor<f32>
    %extracted_slice_229 = tensor.extract_slice %arg0[1, 1, 1] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_230 = tensor.collapse_shape %extracted_slice_229 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_231 = tensor.extract %collapsed_230[] : tensor<f32>
    %extracted_slice_232 = tensor.extract_slice %arg0[1, 1, 0] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_233 = tensor.collapse_shape %extracted_slice_232 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_234 = tensor.extract %collapsed_233[] : tensor<f32>
    %62 = arith.extf %extracted_234 : f32 to f64
    %out_qubits_235 = quantum.custom "RZ"(%62) %out_qubits_152#0 : !quantum.bit
    %63 = arith.extf %extracted_231 : f32 to f64
    %out_qubits_236 = quantum.custom "RY"(%63) %out_qubits_235 : !quantum.bit
    %64 = arith.extf %extracted_228 : f32 to f64
    %out_qubits_237 = quantum.custom "RZ"(%64) %out_qubits_236 : !quantum.bit
    %extracted_slice_238 = tensor.extract_slice %arg0[1, 3, 2] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_239 = tensor.collapse_shape %extracted_slice_238 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_240 = tensor.extract %collapsed_239[] : tensor<f32>
    %extracted_slice_241 = tensor.extract_slice %arg0[1, 3, 1] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_242 = tensor.collapse_shape %extracted_slice_241 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_243 = tensor.extract %collapsed_242[] : tensor<f32>
    %extracted_slice_244 = tensor.extract_slice %arg0[1, 3, 0] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_245 = tensor.collapse_shape %extracted_slice_244 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_246 = tensor.extract %collapsed_245[] : tensor<f32>
    %65 = arith.extf %extracted_246 : f32 to f64
    %out_qubits_247 = quantum.custom "RZ"(%65) %out_qubits_154#0 : !quantum.bit
    %66 = arith.extf %extracted_243 : f32 to f64
    %out_qubits_248 = quantum.custom "RY"(%66) %out_qubits_247 : !quantum.bit
    %67 = arith.extf %extracted_240 : f32 to f64
    %out_qubits_249 = quantum.custom "RZ"(%67) %out_qubits_248 : !quantum.bit
    %out_qubits_250:2 = quantum.custom "CNOT"() %out_qubits_237, %out_qubits_249 : !quantum.bit, !quantum.bit
    %out_qubits_251:2 = quantum.custom "CNOT"() %out_qubits_250#1, %out_qubits_225 : !quantum.bit, !quantum.bit
    %68 = arith.extf %extracted_213 : f32 to f64
    %out_qubits_252 = quantum.custom "RZ"(%68) %out_qubits_251#0 : !quantum.bit
    %69 = arith.extf %extracted_210 : f32 to f64
    %out_qubits_253 = quantum.custom "RY"(%69) %out_qubits_252 : !quantum.bit
    %70 = arith.extf %extracted_207 : f32 to f64
    %out_qubits_254 = quantum.custom "RZ"(%70) %out_qubits_253 : !quantum.bit
    %out_qubits_255:2 = quantum.custom "CNOT"() %out_qubits_204, %out_qubits_254 : !quantum.bit, !quantum.bit
    %extracted_slice_256 = tensor.extract_slice %arg0[2, 2, 2] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_257 = tensor.collapse_shape %extracted_slice_256 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_258 = tensor.extract %collapsed_257[] : tensor<f32>
    %extracted_slice_259 = tensor.extract_slice %arg0[2, 2, 1] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_260 = tensor.collapse_shape %extracted_slice_259 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_261 = tensor.extract %collapsed_260[] : tensor<f32>
    %extracted_slice_262 = tensor.extract_slice %arg0[2, 2, 0] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_263 = tensor.collapse_shape %extracted_slice_262 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_264 = tensor.extract %collapsed_263[] : tensor<f32>
    %71 = arith.extf %extracted_264 : f32 to f64
    %out_qubits_265 = quantum.custom "RZ"(%71) %out_qubits_199#0 : !quantum.bit
    %72 = arith.extf %extracted_261 : f32 to f64
    %out_qubits_266 = quantum.custom "RY"(%72) %out_qubits_265 : !quantum.bit
    %73 = arith.extf %extracted_258 : f32 to f64
    %out_qubits_267 = quantum.custom "RZ"(%73) %out_qubits_266 : !quantum.bit
    %extracted_slice_268 = tensor.extract_slice %arg0[2, 5, 2] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_269 = tensor.collapse_shape %extracted_slice_268 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_270 = tensor.extract %collapsed_269[] : tensor<f32>
    %extracted_slice_271 = tensor.extract_slice %arg0[2, 5, 1] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_272 = tensor.collapse_shape %extracted_slice_271 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_273 = tensor.extract %collapsed_272[] : tensor<f32>
    %extracted_slice_274 = tensor.extract_slice %arg0[2, 5, 0] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_275 = tensor.collapse_shape %extracted_slice_274 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_276 = tensor.extract %collapsed_275[] : tensor<f32>
    %extracted_slice_277 = tensor.extract_slice %arg0[1, 7, 2] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_278 = tensor.collapse_shape %extracted_slice_277 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_279 = tensor.extract %collapsed_278[] : tensor<f32>
    %extracted_slice_280 = tensor.extract_slice %arg0[1, 7, 1] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_281 = tensor.collapse_shape %extracted_slice_280 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_282 = tensor.extract %collapsed_281[] : tensor<f32>
    %extracted_slice_283 = tensor.extract_slice %arg0[1, 7, 0] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_284 = tensor.collapse_shape %extracted_slice_283 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_285 = tensor.extract %collapsed_284[] : tensor<f32>
    %74 = arith.extf %extracted_285 : f32 to f64
    %out_qubits_286 = quantum.custom "RZ"(%74) %out_qubits_182#0 : !quantum.bit
    %75 = arith.extf %extracted_282 : f32 to f64
    %out_qubits_287 = quantum.custom "RY"(%75) %out_qubits_286 : !quantum.bit
    %76 = arith.extf %extracted_279 : f32 to f64
    %out_qubits_288 = quantum.custom "RZ"(%76) %out_qubits_287 : !quantum.bit
    %out_qubits_289:2 = quantum.custom "CNOT"() %out_qubits_251#1, %out_qubits_288 : !quantum.bit, !quantum.bit
    %77 = arith.extf %extracted_276 : f32 to f64
    %out_qubits_290 = quantum.custom "RZ"(%77) %out_qubits_289#0 : !quantum.bit
    %78 = arith.extf %extracted_273 : f32 to f64
    %out_qubits_291 = quantum.custom "RY"(%78) %out_qubits_290 : !quantum.bit
    %79 = arith.extf %extracted_270 : f32 to f64
    %out_qubits_292 = quantum.custom "RZ"(%79) %out_qubits_291 : !quantum.bit
    %out_qubits_293:2 = quantum.custom "CNOT"() %out_qubits_267, %out_qubits_292 : !quantum.bit, !quantum.bit
    %out_qubits_294:2 = quantum.custom "CNOT"() %out_qubits_293#1, %out_qubits_255#0 : !quantum.bit, !quantum.bit
    %80 = arith.extf %extracted_5 : f32 to f64
    %out_qubits_295 = quantum.custom "RZ"(%80) %out_qubits_294#1 : !quantum.bit
    %81 = arith.extf %extracted_2 : f32 to f64
    %out_qubits_296 = quantum.custom "RY"(%81) %out_qubits_295 : !quantum.bit
    %82 = arith.extf %extracted : f32 to f64
    %out_qubits_297 = quantum.custom "RZ"(%82) %out_qubits_296 : !quantum.bit
    %extracted_slice_298 = tensor.extract_slice %arg0[3, 4, 2] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_299 = tensor.collapse_shape %extracted_slice_298 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_300 = tensor.extract %collapsed_299[] : tensor<f32>
    %extracted_slice_301 = tensor.extract_slice %arg0[3, 4, 1] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_302 = tensor.collapse_shape %extracted_slice_301 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_303 = tensor.extract %collapsed_302[] : tensor<f32>
    %extracted_slice_304 = tensor.extract_slice %arg0[3, 4, 0] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_305 = tensor.collapse_shape %extracted_slice_304 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_306 = tensor.extract %collapsed_305[] : tensor<f32>
    %extracted_slice_307 = tensor.extract_slice %arg0[2, 7, 2] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_308 = tensor.collapse_shape %extracted_slice_307 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_309 = tensor.extract %collapsed_308[] : tensor<f32>
    %extracted_slice_310 = tensor.extract_slice %arg0[2, 7, 1] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_311 = tensor.collapse_shape %extracted_slice_310 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_312 = tensor.extract %collapsed_311[] : tensor<f32>
    %extracted_slice_313 = tensor.extract_slice %arg0[2, 7, 0] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_314 = tensor.collapse_shape %extracted_slice_313 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_315 = tensor.extract %collapsed_314[] : tensor<f32>
    %out_qubits_316:2 = quantum.custom "CNOT"() %out_qubits_289#1, %out_qubits_250#0 : !quantum.bit, !quantum.bit
    %83 = arith.extf %extracted_315 : f32 to f64
    %out_qubits_317 = quantum.custom "RZ"(%83) %out_qubits_316#0 : !quantum.bit
    %84 = arith.extf %extracted_312 : f32 to f64
    %out_qubits_318 = quantum.custom "RY"(%84) %out_qubits_317 : !quantum.bit
    %85 = arith.extf %extracted_309 : f32 to f64
    %out_qubits_319 = quantum.custom "RZ"(%85) %out_qubits_318 : !quantum.bit
    %extracted_slice_320 = tensor.extract_slice %arg0[2, 1, 2] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_321 = tensor.collapse_shape %extracted_slice_320 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_322 = tensor.extract %collapsed_321[] : tensor<f32>
    %extracted_slice_323 = tensor.extract_slice %arg0[2, 1, 1] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_324 = tensor.collapse_shape %extracted_slice_323 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_325 = tensor.extract %collapsed_324[] : tensor<f32>
    %extracted_slice_326 = tensor.extract_slice %arg0[2, 1, 0] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_327 = tensor.collapse_shape %extracted_slice_326 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_328 = tensor.extract %collapsed_327[] : tensor<f32>
    %86 = arith.extf %extracted_328 : f32 to f64
    %out_qubits_329 = quantum.custom "RZ"(%86) %out_qubits_316#1 : !quantum.bit
    %87 = arith.extf %extracted_325 : f32 to f64
    %out_qubits_330 = quantum.custom "RY"(%87) %out_qubits_329 : !quantum.bit
    %88 = arith.extf %extracted_322 : f32 to f64
    %out_qubits_331 = quantum.custom "RZ"(%88) %out_qubits_330 : !quantum.bit
    %extracted_slice_332 = tensor.extract_slice %arg0[2, 4, 2] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_333 = tensor.collapse_shape %extracted_slice_332 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_334 = tensor.extract %collapsed_333[] : tensor<f32>
    %extracted_slice_335 = tensor.extract_slice %arg0[2, 4, 1] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_336 = tensor.collapse_shape %extracted_slice_335 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_337 = tensor.extract %collapsed_336[] : tensor<f32>
    %extracted_slice_338 = tensor.extract_slice %arg0[2, 4, 0] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_339 = tensor.collapse_shape %extracted_slice_338 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_340 = tensor.extract %collapsed_339[] : tensor<f32>
    %89 = arith.extf %extracted_340 : f32 to f64
    %out_qubits_341 = quantum.custom "RZ"(%89) %out_qubits_200#0 : !quantum.bit
    %90 = arith.extf %extracted_337 : f32 to f64
    %out_qubits_342 = quantum.custom "RY"(%90) %out_qubits_341 : !quantum.bit
    %91 = arith.extf %extracted_334 : f32 to f64
    %out_qubits_343 = quantum.custom "RZ"(%91) %out_qubits_342 : !quantum.bit
    %out_qubits_344:2 = quantum.custom "CNOT"() %out_qubits_331, %out_qubits_343 : !quantum.bit, !quantum.bit
    %out_qubits_345:2 = quantum.custom "CNOT"() %out_qubits_344#1, %out_qubits_319 : !quantum.bit, !quantum.bit
    %92 = arith.extf %extracted_306 : f32 to f64
    %out_qubits_346 = quantum.custom "RZ"(%92) %out_qubits_345#0 : !quantum.bit
    %93 = arith.extf %extracted_303 : f32 to f64
    %out_qubits_347 = quantum.custom "RY"(%93) %out_qubits_346 : !quantum.bit
    %94 = arith.extf %extracted_300 : f32 to f64
    %out_qubits_348 = quantum.custom "RZ"(%94) %out_qubits_347 : !quantum.bit
    %out_qubits_349:2 = quantum.custom "CNOT"() %out_qubits_297, %out_qubits_348 : !quantum.bit, !quantum.bit
    %out_qubits_350:2 = quantum.custom "CNOT"() %out_qubits_349#1, %out_qubits_349#0 : !quantum.bit, !quantum.bit
    %extracted_slice_351 = tensor.extract_slice %arg0[3, 1, 2] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_352 = tensor.collapse_shape %extracted_slice_351 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_353 = tensor.extract %collapsed_352[] : tensor<f32>
    %extracted_slice_354 = tensor.extract_slice %arg0[3, 1, 1] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_355 = tensor.collapse_shape %extracted_slice_354 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_356 = tensor.extract %collapsed_355[] : tensor<f32>
    %extracted_slice_357 = tensor.extract_slice %arg0[3, 1, 0] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_358 = tensor.collapse_shape %extracted_slice_357 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_359 = tensor.extract %collapsed_358[] : tensor<f32>
    %extracted_slice_360 = tensor.extract_slice %arg0[2, 6, 2] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_361 = tensor.collapse_shape %extracted_slice_360 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_362 = tensor.extract %collapsed_361[] : tensor<f32>
    %extracted_slice_363 = tensor.extract_slice %arg0[2, 6, 1] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_364 = tensor.collapse_shape %extracted_slice_363 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_365 = tensor.extract %collapsed_364[] : tensor<f32>
    %extracted_slice_366 = tensor.extract_slice %arg0[2, 6, 0] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_367 = tensor.collapse_shape %extracted_slice_366 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_368 = tensor.extract %collapsed_367[] : tensor<f32>
    %95 = arith.extf %extracted_368 : f32 to f64
    %out_qubits_369 = quantum.custom "RZ"(%95) %out_qubits_201#0 : !quantum.bit
    %96 = arith.extf %extracted_365 : f32 to f64
    %out_qubits_370 = quantum.custom "RY"(%96) %out_qubits_369 : !quantum.bit
    %97 = arith.extf %extracted_362 : f32 to f64
    %out_qubits_371 = quantum.custom "RZ"(%97) %out_qubits_370 : !quantum.bit
    %out_qubits_372:2 = quantum.custom "CNOT"() %out_qubits_255#1, %out_qubits_371 : !quantum.bit, !quantum.bit
    %out_qubits_373:2 = quantum.custom "CNOT"() %out_qubits_372#1, %out_qubits_344#0 : !quantum.bit, !quantum.bit
    %98 = arith.extf %extracted_359 : f32 to f64
    %out_qubits_374 = quantum.custom "RZ"(%98) %out_qubits_373#1 : !quantum.bit
    %99 = arith.extf %extracted_356 : f32 to f64
    %out_qubits_375 = quantum.custom "RY"(%99) %out_qubits_374 : !quantum.bit
    %100 = arith.extf %extracted_353 : f32 to f64
    %out_qubits_376 = quantum.custom "RZ"(%100) %out_qubits_375 : !quantum.bit
    %extracted_slice_377 = tensor.extract_slice %arg0[3, 5, 2] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_378 = tensor.collapse_shape %extracted_slice_377 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_379 = tensor.extract %collapsed_378[] : tensor<f32>
    %extracted_slice_380 = tensor.extract_slice %arg0[3, 5, 1] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_381 = tensor.collapse_shape %extracted_slice_380 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_382 = tensor.extract %collapsed_381[] : tensor<f32>
    %extracted_slice_383 = tensor.extract_slice %arg0[3, 5, 0] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_384 = tensor.collapse_shape %extracted_slice_383 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_385 = tensor.extract %collapsed_384[] : tensor<f32>
    %101 = arith.extf %extracted_385 : f32 to f64
    %out_qubits_386 = quantum.custom "RZ"(%101) %out_qubits_294#0 : !quantum.bit
    %102 = arith.extf %extracted_382 : f32 to f64
    %out_qubits_387 = quantum.custom "RY"(%102) %out_qubits_386 : !quantum.bit
    %103 = arith.extf %extracted_379 : f32 to f64
    %out_qubits_388 = quantum.custom "RZ"(%103) %out_qubits_387 : !quantum.bit
    %out_qubits_389:2 = quantum.custom "CNOT"() %out_qubits_376, %out_qubits_388 : !quantum.bit, !quantum.bit
    %out_qubits_390:2 = quantum.custom "CNOT"() %out_qubits_389#1, %out_qubits_389#0 : !quantum.bit, !quantum.bit
    %extracted_slice_391 = tensor.extract_slice %arg0[3, 2, 2] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_392 = tensor.collapse_shape %extracted_slice_391 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_393 = tensor.extract %collapsed_392[] : tensor<f32>
    %extracted_slice_394 = tensor.extract_slice %arg0[3, 2, 1] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_395 = tensor.collapse_shape %extracted_slice_394 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_396 = tensor.extract %collapsed_395[] : tensor<f32>
    %extracted_slice_397 = tensor.extract_slice %arg0[3, 2, 0] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_398 = tensor.collapse_shape %extracted_slice_397 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_399 = tensor.extract %collapsed_398[] : tensor<f32>
    %out_qubits_400:2 = quantum.custom "CNOT"() %out_qubits_345#1, %out_qubits_293#0 : !quantum.bit, !quantum.bit
    %104 = arith.extf %extracted_399 : f32 to f64
    %out_qubits_401 = quantum.custom "RZ"(%104) %out_qubits_400#1 : !quantum.bit
    %105 = arith.extf %extracted_396 : f32 to f64
    %out_qubits_402 = quantum.custom "RY"(%105) %out_qubits_401 : !quantum.bit
    %106 = arith.extf %extracted_393 : f32 to f64
    %out_qubits_403 = quantum.custom "RZ"(%106) %out_qubits_402 : !quantum.bit
    %extracted_slice_404 = tensor.extract_slice %arg0[3, 6, 2] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_405 = tensor.collapse_shape %extracted_slice_404 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_406 = tensor.extract %collapsed_405[] : tensor<f32>
    %extracted_slice_407 = tensor.extract_slice %arg0[3, 6, 1] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_408 = tensor.collapse_shape %extracted_slice_407 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_409 = tensor.extract %collapsed_408[] : tensor<f32>
    %extracted_slice_410 = tensor.extract_slice %arg0[3, 6, 0] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_411 = tensor.collapse_shape %extracted_slice_410 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_412 = tensor.extract %collapsed_411[] : tensor<f32>
    %107 = arith.extf %extracted_412 : f32 to f64
    %out_qubits_413 = quantum.custom "RZ"(%107) %out_qubits_373#0 : !quantum.bit
    %108 = arith.extf %extracted_409 : f32 to f64
    %out_qubits_414 = quantum.custom "RY"(%108) %out_qubits_413 : !quantum.bit
    %109 = arith.extf %extracted_406 : f32 to f64
    %out_qubits_415 = quantum.custom "RZ"(%109) %out_qubits_414 : !quantum.bit
    %out_qubits_416:2 = quantum.custom "CNOT"() %out_qubits_403, %out_qubits_415 : !quantum.bit, !quantum.bit
    %out_qubits_417:2 = quantum.custom "CNOT"() %out_qubits_416#1, %out_qubits_416#0 : !quantum.bit, !quantum.bit
    %extracted_slice_418 = tensor.extract_slice %arg0[3, 3, 2] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_419 = tensor.collapse_shape %extracted_slice_418 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_420 = tensor.extract %collapsed_419[] : tensor<f32>
    %extracted_slice_421 = tensor.extract_slice %arg0[3, 3, 1] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_422 = tensor.collapse_shape %extracted_slice_421 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_423 = tensor.extract %collapsed_422[] : tensor<f32>
    %extracted_slice_424 = tensor.extract_slice %arg0[3, 3, 0] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_425 = tensor.collapse_shape %extracted_slice_424 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_426 = tensor.extract %collapsed_425[] : tensor<f32>
    %110 = arith.extf %extracted_426 : f32 to f64
    %out_qubits_427 = quantum.custom "RZ"(%110) %out_qubits_372#0 : !quantum.bit
    %111 = arith.extf %extracted_423 : f32 to f64
    %out_qubits_428 = quantum.custom "RY"(%111) %out_qubits_427 : !quantum.bit
    %112 = arith.extf %extracted_420 : f32 to f64
    %out_qubits_429 = quantum.custom "RZ"(%112) %out_qubits_428 : !quantum.bit
    %extracted_slice_430 = tensor.extract_slice %arg0[3, 7, 2] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_431 = tensor.collapse_shape %extracted_slice_430 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_432 = tensor.extract %collapsed_431[] : tensor<f32>
    %extracted_slice_433 = tensor.extract_slice %arg0[3, 7, 1] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_434 = tensor.collapse_shape %extracted_slice_433 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_435 = tensor.extract %collapsed_434[] : tensor<f32>
    %extracted_slice_436 = tensor.extract_slice %arg0[3, 7, 0] [1, 1, 1] [1, 1, 1] : tensor<4x8x3xf32> to tensor<1x1x1xf32>
    %collapsed_437 = tensor.collapse_shape %extracted_slice_436 [] : tensor<1x1x1xf32> into tensor<f32>
    %extracted_438 = tensor.extract %collapsed_437[] : tensor<f32>
    %113 = arith.extf %extracted_438 : f32 to f64
    %out_qubits_439 = quantum.custom "RZ"(%113) %out_qubits_400#0 : !quantum.bit
    %114 = arith.extf %extracted_435 : f32 to f64
    %out_qubits_440 = quantum.custom "RY"(%114) %out_qubits_439 : !quantum.bit
    %115 = arith.extf %extracted_432 : f32 to f64
    %out_qubits_441 = quantum.custom "RZ"(%115) %out_qubits_440 : !quantum.bit
    %out_qubits_442:2 = quantum.custom "CNOT"() %out_qubits_429, %out_qubits_441 : !quantum.bit, !quantum.bit
    %out_qubits_443:2 = quantum.custom "CNOT"() %out_qubits_442#1, %out_qubits_442#0 : !quantum.bit, !quantum.bit
    %116 = quantum.namedobs %out_qubits_350#1[ PauliZ] : !quantum.obs
    %117 = quantum.expval %116 : f64
    %from_elements = tensor.from_elements %117 : tensor<f64>
    %118 = quantum.insert %3[ 0], %out_qubits_350#1 : !quantum.reg, !quantum.bit
    %119 = quantum.insert %118[ 1], %out_qubits_390#1 : !quantum.reg, !quantum.bit
    %120 = quantum.insert %119[ 2], %out_qubits_417#1 : !quantum.reg, !quantum.bit
    %121 = quantum.insert %120[ 3], %out_qubits_443#1 : !quantum.reg, !quantum.bit
    %122 = quantum.insert %121[ 4], %out_qubits_350#0 : !quantum.reg, !quantum.bit
    %123 = quantum.insert %122[ 5], %out_qubits_390#0 : !quantum.reg, !quantum.bit
    %124 = quantum.insert %123[ 6], %out_qubits_417#0 : !quantum.reg, !quantum.bit
    %125 = quantum.insert %124[ 7], %out_qubits_443#0 : !quantum.reg, !quantum.bit
    quantum.dealloc %125 : !quantum.reg
    quantum.device_release
    return %from_elements : tensor<f64>
  }
  func.func @setup() {
    quantum.init
    return
  }
  func.func @teardown() {
    quantum.finalize
    return
  }
}