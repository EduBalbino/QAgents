--- Starting Data Preparation ---
Quickly scanning file to count rows...
File has 157800 rows. Loading a random sample of 157800 rows.
Dataset loaded. Final shape: (157800, 63)
Dataset Columns: Index(['frame.time', 'ip.src_host', 'ip.dst_host', 'arp.dst.proto_ipv4',
       'arp.opcode', 'arp.hw.size', 'arp.src.proto_ipv4', 'icmp.checksum',
       'icmp.seq_le', 'icmp.transmit_timestamp', 'icmp.unused',
       'http.file_data', 'http.content_length', 'http.request.uri.query',
       'http.request.method', 'http.referer', 'http.request.full_uri',
       'http.request.version', 'http.response', 'http.tls_port', 'tcp.ack',
       'tcp.ack_raw', 'tcp.checksum', 'tcp.connection.fin',
       'tcp.connection.rst', 'tcp.connection.syn', 'tcp.connection.synack',
       'tcp.dstport', 'tcp.flags', 'tcp.flags.ack', 'tcp.len', 'tcp.options',
       'tcp.payload', 'tcp.seq', 'tcp.srcport', 'udp.port', 'udp.stream',
       'udp.time_delta', 'dns.qry.name', 'dns.qry.name.len', 'dns.qry.qu',
       'dns.qry.type', 'dns.retransmission', 'dns.retransmit_request',
       'dns.retransmit_request_in', 'mqtt.conack.flags',
       'mqtt.conflag.cleansess', 'mqtt.conflags', 'mqtt.hdrflags', 'mqtt.len',
       'mqtt.msg_decoded_as', 'mqtt.msg', 'mqtt.msgtype', 'mqtt.proto_len',
       'mqtt.protoname', 'mqtt.topic', 'mqtt.topic_len', 'mqtt.ver',
       'mbtcp.len', 'mbtcp.trans_id', 'mbtcp.unit_id', 'Attack_label',
       'Attack_type'],
      dtype='object')
Features and labels extracted.
Data split into training and testing sets.
X_train shape: (126240, 8)
X_test shape: (31560, 8)
Features scaled.
Labels transformed.
Data preparation complete. Time elapsed: 1.47 seconds.

--- Starting Quantum Setup ---
Initializing lightning.qubit device with 8 qubits for multi-core performance.
Quantum device initialized.

--- Initializing Training ---
Training for 1 epoch (1262 iterations for a training set of size 126240).
Validation set created with 500 data points.

Class weights computed for handling imbalance: {tensor(-1, requires_grad=False): np.float64(3.246746566534643), tensor(1, requires_grad=False): np.float64(0.5910167698199421)}
Parameters initialized. Starting training for 1262 iterations with batch size 100.
Iter:    10 | Batch Cost: 0.7508209 | Batch Acc: 0.9000000
Iter:    20 | Batch Cost: 1.1030289 | Batch Acc: 0.2800000
Iter:    30 | Batch Cost: 1.1303939 | Batch Acc: 0.3600000
Iter:    40 | Batch Cost: 0.8634582 | Batch Acc: 0.5900000
Iter:    50 | Batch Cost: 0.9684311 | Batch Acc: 0.6500000
Iter:    60 | Batch Cost: 0.7989897 | Batch Acc: 0.7100000
Iter:    70 | Batch Cost: 0.9376395 | Batch Acc: 0.6600000
Iter:    80 | Batch Cost: 0.9185910 | Batch Acc: 0.6600000
Iter:    90 | Batch Cost: 0.7218886 | Batch Acc: 0.7200000
Iter:   100 | Batch Cost: 0.8947215 | Batch Acc: 0.6600000
Iter:   110 | Batch Cost: 0.9229120 | Batch Acc: 0.6800000
Iter:   120 | Batch Cost: 0.8159328 | Batch Acc: 0.7700000
Iter:   130 | Batch Cost: 1.1856012 | Batch Acc: 0.3000000
Iter:   140 | Batch Cost: 1.0529792 | Batch Acc: 0.6500000
Iter:   150 | Batch Cost: 0.8094633 | Batch Acc: 0.7500000
Iter:   160 | Batch Cost: 1.0010203 | Batch Acc: 0.7100000
Iter:   170 | Batch Cost: 0.9931288 | Batch Acc: 0.6400000
Iter:   180 | Batch Cost: 0.6737717 | Batch Acc: 0.7900000
Iter:   190 | Batch Cost: 0.6680360 | Batch Acc: 0.7600000
Iter:   200 | Batch Cost: 1.2776843 | Batch Acc: 0.2500000
Iter:   210 | Batch Cost: 0.8602303 | Batch Acc: 0.7000000
Iter:   220 | Batch Cost: 1.0473620 | Batch Acc: 0.6500000
Iter:   230 | Batch Cost: 0.6838459 | Batch Acc: 0.7400000
Iter:   240 | Batch Cost: 0.8915720 | Batch Acc: 0.7200000
Iter:   250 | Batch Cost: 0.8126328 | Batch Acc: 0.7800000
Iter:   260 | Batch Cost: 0.8293855 | Batch Acc: 0.7000000
Iter:   270 | Batch Cost: 0.9470125 | Batch Acc: 0.6900000
Iter:   280 | Batch Cost: 1.0100336 | Batch Acc: 0.7300000
Iter:   290 | Batch Cost: 0.8645287 | Batch Acc: 0.7800000
Iter:   300 | Batch Cost: 0.8123326 | Batch Acc: 0.8600000
Iter:   310 | Batch Cost: 0.8940968 | Batch Acc: 0.7700000
Iter:   320 | Batch Cost: 0.8112121 | Batch Acc: 0.7000000
Iter:   330 | Batch Cost: 1.1947892 | Batch Acc: 0.3200000
Iter:   340 | Batch Cost: 0.8107392 | Batch Acc: 0.7100000
Iter:   350 | Batch Cost: 1.0131555 | Batch Acc: 0.6300000
Iter:   360 | Batch Cost: 0.8581531 | Batch Acc: 0.6800000
Iter:   370 | Batch Cost: 0.7535557 | Batch Acc: 0.7500000
Iter:   380 | Batch Cost: 0.9286465 | Batch Acc: 0.7600000
Iter:   390 | Batch Cost: 1.0842307 | Batch Acc: 0.4500000
Iter:   400 | Batch Cost: 0.8706988 | Batch Acc: 0.7500000
Iter:   410 | Batch Cost: 0.9376263 | Batch Acc: 0.7100000
Iter:   420 | Batch Cost: 0.6931994 | Batch Acc: 0.7700000
Iter:   430 | Batch Cost: 0.8092053 | Batch Acc: 0.7200000
Iter:   440 | Batch Cost: 0.9908685 | Batch Acc: 0.6700000
Iter:   450 | Batch Cost: 1.1298886 | Batch Acc: 0.3500000
Iter:   460 | Batch Cost: 0.9369272 | Batch Acc: 0.6500000
Iter:   470 | Batch Cost: 0.7957710 | Batch Acc: 0.8100000
Iter:   480 | Batch Cost: 0.9190602 | Batch Acc: 0.6800000
Iter:   490 | Batch Cost: 1.0179987 | Batch Acc: 0.5900000
Iter:   500 | Batch Cost: 1.0201496 | Batch Acc: 0.6400000
Iter:   510 | Batch Cost: 0.8801333 | Batch Acc: 0.6900000
Iter:   520 | Batch Cost: 1.0208065 | Batch Acc: 0.6800000
Iter:   530 | Batch Cost: 0.7366208 | Batch Acc: 0.7500000
Iter:   540 | Batch Cost: 0.7974853 | Batch Acc: 0.7500000
Iter:   550 | Batch Cost: 0.8155316 | Batch Acc: 0.7400000
Iter:   560 | Batch Cost: 0.7665194 | Batch Acc: 0.7400000
Iter:   570 | Batch Cost: 0.9922772 | Batch Acc: 0.6700000
Iter:   580 | Batch Cost: 0.9861155 | Batch Acc: 0.6900000
Iter:   590 | Batch Cost: 0.6940716 | Batch Acc: 0.7500000
Iter:   600 | Batch Cost: 1.1714580 | Batch Acc: 0.2900000
Iter:   610 | Batch Cost: 0.7988281 | Batch Acc: 0.7300000
Iter:   620 | Batch Cost: 1.0131941 | Batch Acc: 0.7200000
Iter:   630 | Batch Cost: 0.6638724 | Batch Acc: 0.7800000
Iter:   640 | Batch Cost: 0.7539307 | Batch Acc: 0.7700000
Iter:   650 | Batch Cost: 0.5923042 | Batch Acc: 0.8200000
Iter:   660 | Batch Cost: 0.6621719 | Batch Acc: 0.8600000
Iter:   670 | Batch Cost: 0.7813380 | Batch Acc: 0.7400000
Iter:   680 | Batch Cost: 0.9110040 | Batch Acc: 0.6400000
Iter:   690 | Batch Cost: 1.0974826 | Batch Acc: 0.5800000
Iter:   700 | Batch Cost: 0.8132392 | Batch Acc: 0.7600000
Iter:   710 | Batch Cost: 1.0004966 | Batch Acc: 0.6600000
Iter:   720 | Batch Cost: 0.9158567 | Batch Acc: 0.7300000
Iter:   730 | Batch Cost: 0.8058113 | Batch Acc: 0.7600000
Iter:   740 | Batch Cost: 0.8222996 | Batch Acc: 0.7500000
Iter:   750 | Batch Cost: 0.8633375 | Batch Acc: 0.7100000
Iter:   760 | Batch Cost: 0.9201269 | Batch Acc: 0.7500000
Iter:   770 | Batch Cost: 0.9487814 | Batch Acc: 0.7200000
Iter:   780 | Batch Cost: 0.7870060 | Batch Acc: 0.7200000
Iter:   790 | Batch Cost: 0.6926506 | Batch Acc: 0.7700000
Iter:   800 | Batch Cost: 1.0811742 | Batch Acc: 0.6900000
Iter:   810 | Batch Cost: 0.8563833 | Batch Acc: 0.6900000
Iter:   820 | Batch Cost: 0.9368612 | Batch Acc: 0.7300000
Iter:   830 | Batch Cost: 0.9847421 | Batch Acc: 0.6600000
Iter:   840 | Batch Cost: 0.7650741 | Batch Acc: 0.7600000
Iter:   850 | Batch Cost: 0.8615369 | Batch Acc: 0.7500000
Iter:   860 | Batch Cost: 0.7604011 | Batch Acc: 0.7300000
Iter:   870 | Batch Cost: 0.9235633 | Batch Acc: 0.7500000
Iter:   880 | Batch Cost: 1.0171109 | Batch Acc: 0.6500000
Iter:   890 | Batch Cost: 0.9513991 | Batch Acc: 0.6200000
Iter:   900 | Batch Cost: 0.9161017 | Batch Acc: 0.7400000
Iter:   910 | Batch Cost: 0.7852968 | Batch Acc: 0.7300000
Iter:   920 | Batch Cost: 0.6712126 | Batch Acc: 0.7600000
Iter:   930 | Batch Cost: 1.0456733 | Batch Acc: 0.6000000
Iter:   940 | Batch Cost: 0.9922594 | Batch Acc: 0.6200000
Iter:   950 | Batch Cost: 0.8793552 | Batch Acc: 0.6900000
Iter:   960 | Batch Cost: 0.8912891 | Batch Acc: 0.7300000
Iter:   970 | Batch Cost: 0.7713110 | Batch Acc: 0.7600000
Iter:   980 | Batch Cost: 0.9198308 | Batch Acc: 0.6900000
Iter:   990 | Batch Cost: 0.6922866 | Batch Acc: 0.7300000
Iter:  1000 | Batch Cost: 0.6713497 | Batch Acc: 0.9400000
Iter:  1010 | Batch Cost: 0.7713534 | Batch Acc: 0.8100000
Iter:  1020 | Batch Cost: 0.7140112 | Batch Acc: 0.7500000
Iter:  1030 | Batch Cost: 0.6893898 | Batch Acc: 0.8100000
Iter:  1040 | Batch Cost: 0.9767215 | Batch Acc: 0.7000000
Iter:  1050 | Batch Cost: 0.7741774 | Batch Acc: 0.7400000
Iter:  1060 | Batch Cost: 1.0630621 | Batch Acc: 0.5600000
Iter:  1070 | Batch Cost: 1.0200733 | Batch Acc: 0.6900000
Iter:  1080 | Batch Cost: 0.8136543 | Batch Acc: 0.7000000
Iter:  1090 | Batch Cost: 0.8559786 | Batch Acc: 0.7700000
Iter:  1100 | Batch Cost: 0.8419527 | Batch Acc: 0.7900000
Iter:  1110 | Batch Cost: 1.0574288 | Batch Acc: 0.6500000
Iter:  1120 | Batch Cost: 0.9631994 | Batch Acc: 0.6700000
Iter:  1130 | Batch Cost: 0.8654142 | Batch Acc: 0.7500000
Iter:  1140 | Batch Cost: 0.9640069 | Batch Acc: 0.6600000
Iter:  1150 | Batch Cost: 0.9552684 | Batch Acc: 0.7200000
Iter:  1160 | Batch Cost: 1.0819397 | Batch Acc: 0.3500000
Iter:  1170 | Batch Cost: 0.9821614 | Batch Acc: 0.7800000
Iter:  1180 | Batch Cost: 1.0103417 | Batch Acc: 0.6700000
Iter:  1190 | Batch Cost: 0.7848199 | Batch Acc: 0.7900000
Iter:  1200 | Batch Cost: 0.7071152 | Batch Acc: 0.7300000
Iter:  1210 | Batch Cost: 0.7965513 | Batch Acc: 0.7100000
Iter:  1220 | Batch Cost: 0.9767224 | Batch Acc: 0.7100000
Iter:  1230 | Batch Cost: 0.6507382 | Batch Acc: 0.7700000
Iter:  1240 | Batch Cost: 1.1049212 | Batch Acc: 0.5700000
Iter:  1250 | Batch Cost: 1.0113397 | Batch Acc: 0.6700000
Iter:  1260 | Batch Cost: 0.9366123 | Batch Acc: 0.7100000
Iter:  1262 | Batch Cost: 0.8945123 | Batch Acc: 0.6900000

Training loop finished. Total training time: 701.45 seconds.

--- Running Quick Validation Check ---
Validation Cost: 0.9196954 | Validation Accuracy: 0.6880000
Validation check completed in: 2.27 seconds.

--- Evaluating model on test data ---
Test set is large, processing in mini-batches.
--- Test Results ---
Acurácia (Overall): 0.7153
Acurácia (Benign):  0.5403 (from 4860 samples)
Acurácia (Attack):  0.7472 (from 26700 samples)
Precisão: 0.5897
Recall:   0.6437
F1-Score: 0.5925
--------------------
Evaluation finished in: 141.60 seconds.
